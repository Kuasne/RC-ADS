<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard - UNIFAA</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet" />
    <link href="css/style.css" rel="stylesheet" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
        .card-header-custom {
            background: linear-gradient(to right, #1EAE5F, #0BAEE9);
            color: #fff;
        }
        .disciplina-circle {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-weight: bold;
            font-size: 1.2rem;
        }
        .bg-matematica { background: #2563eb; }
        .bg-portugues { background: #22c55e; }
        .bg-historia { background: #eab308; }
        .bg-geografia { background: #a21caf; }
        .bg-ciencias { background: #14b8a6; }
        .bg-fisica { background: #ef4444; }
        .bg-quimica { background: #6366f1; }
        .bg-default { background: #6b7280; }
    </style>
</head>

<body class="dashboard-page">
    <button id="deuteranopia-toggle" class="btn-accessibility" title="Modo Daltonismo">Modo Daltonismo</button>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-custom" style="background: #1EAE5F;">
        <div class="container">
            <a class="navbar-brand" href="#">
                <img src="images/unifaa-logo.png" alt="UNIFAA" class="me-2" />
                <span class="text-white fw-bold">Portal do Aluno</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="#dashboard.html">
                            <i class="bi bi-calendar-plus me-1"></i>Agendamento
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="minhas-provas.html">
                            <i class="bi bi-list-check me-1"></i>Minhas Provas
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="#contato">
                            <i class="bi bi-envelope me-1"></i>Contato
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle text-white" href="#" role="button" data-bs-toggle="dropdown">
                            <i class="bi bi-person-circle me-1"></i>Aluno
                        </a>
                        <ul class="dropdown-menu">
                            <li>
                                <a class="dropdown-item" href="#"><i class="bi bi-person me-2"></i>Perfil</a>
                            </li>
                            <li>
                                <a class="dropdown-item" href="#"><i class="bi bi-gear me-2"></i>Configurações</a>
                            </li>
                            <li>
                                <hr class="dropdown-divider" />
                            </li>
                            <li>
                                <a class="dropdown-item" href="index.html"><i class="bi bi-box-arrow-right me-2"></i>Sair</a>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Conteúdo Principal -->
    <div class="main-content mt-4">
        <div class="container">
            <!-- Seção de Boas-vindas -->
            <div class="row align-items-center mb-4">
                <div class="col-md-8">
                    <h1 class="fw-bold">Bem-vindo ao Portal de Agendamento</h1>
                    <p class="lead text-muted">
                        Gerencie seus agendamentos de provas de forma prática e eficiente
                    </p>
                </div>
                <div class="col-md-4 text-end">
                    <img src="images/estudantes.jpg" alt="Estudantes" class="img-fluid rounded" style="max-height: 120px" />
                </div>
            </div>

            <div class="row">
                <!-- Formulário de Agendamento -->
                <div class="col-lg-5 mb-4">
                    <div class="card h-100 shadow-sm" id="agendamento">
                        <div class="card-header card-header-custom">
                            <h3 class="card-title mb-0"><i class="bi bi-calendar-plus me-2"></i>Agendar Nova Prova</h3>
                        </div>
                        <div class="card-body">
                            <h2 class="fs-5 mb-4">Dados do Agendamento</h2>
                            <form id="formAgendamento" onsubmit="event.preventDefault(); agendarProva();">
                                <div class="mb-3">
    <label class="form-label">Disciplina</label>
    <select id="disciplina" class="form-select">
        <option value="">Selecione a disciplina</option>
        <option value="algoritmos">Algoritmos e Lógica de Programação</option>
        <option value="programacao">Programação Orientada a Objetos</option>
        <option value="bd">Banco de Dados</option>
        <option value="engenharia">Engenharia de Software</option>
        <option value="web">Desenvolvimento Web</option>
        <option value="redes">Redes de Computadores</option>
        <option value="seguranca">Segurança da Informação</option>
    </select>
</div>
                                <div class="mb-3">
                                    <label class="form-label">Data</label>
                                    <input type="date" id="data" class="form-control">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">Horário</label>
                                    <select id="horario" class="form-select">
                                        <option value="">Selecione o horário</option>
                                        <option value="08:00">08:00 - 09:30</option>
                                        <option value="10:00">10:00 - 11:30</option>
                                        <option value="14:00">14:00 - 15:30</option>
                                        <option value="16:00">16:00 - 17:30</option>
                                    </select>
                                </div>
                                <button type="submit" class="btn btn-primary w-100 mt-2">
                                    Salvar
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                <!-- Calendário/Lista de Provas Agendadas -->
                <div class="col-lg-7 mb-4">
    <div class="card h-100 shadow-sm">
        <div class="card-header card-header-custom">
            <h3 class="card-title mb-0 text-white">
                <i class="bi bi-list-check me-2"></i>Provas Agendadas
            </h3>
        </div>
        <div class="card-body">
            <div id="provasAgendadas" class="mb-3">
                <!-- Provas agendadas aparecerão aqui -->
            </div>
            <div id="emptyState" class="text-center py-5 text-muted">
                <svg class="mx-auto mb-3" height="48" width="48" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                </svg>
                <p>Nenhuma prova agendada ainda</p>
                <p class="text-sm">Use o formulário ao lado para agendar sua primeira prova</p>
            </div>
        </div>
    </div>
</div>
            <!-- Cards de Estatísticas -->
            <div class="row mt-3">
                <div class="col-md-4 mb-3">
                    <div class="card text-center shadow-sm">
                        <div class="card-body">
                            <div class="fs-2 fw-bold text-primary" id="totalProvas">0</div>
                            <div class="text-muted">Total de Provas</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="card text-center shadow-sm">
                        <div class="card-body">
                            <div class="fs-2 fw-bold text-success" id="proximaProva">-</div>
                            <div class="text-muted">Próxima Prova</div>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 mb-3">
                    <div class="card text-center shadow-sm">
                        <div class="card-body">
                            <div class="fs-2 fw-bold text-info" id="disciplinasCount">0</div>
                            <div class="text-muted">Disciplinas</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let provas = [];

        function agendarProva() {
            const disciplina = document.getElementById('disciplina').value;
            const data = document.getElementById('data').value;
            const horario = document.getElementById('horario').value;

            if (!disciplina || !data || !horario) {
                alert('Por favor, preencha todos os campos obrigatórios!');
                return;
            }

            // Verificar se a disciplina já foi agendada
            const disciplinaJaAgendada = provas.find(prova => prova.disciplina === disciplina);
            if (disciplinaJaAgendada) {
                alert(`A disciplina ${document.getElementById('disciplina').selectedOptions[0].text} já foi agendada!`);
                return;
            }

            // Verificar se já existe uma prova no mesmo horário e data
            const conflito = provas.find(prova => prova.data === data && prova.horario === horario);
            if (conflito) {
                alert(`Já existe uma prova agendada para ${data} às ${document.getElementById('horario').selectedOptions[0].text}!`);
                return;
            }

            const novaProva = {
                id: Date.now(),
                disciplina: disciplina,
                disciplinaNome: document.getElementById('disciplina').selectedOptions[0].text,
                data: data,
                horario: horario,
                horarioTexto: document.getElementById('horario').selectedOptions[0].text
            };

            provas.push(novaProva);
            provas.sort((a, b) => new Date(a.data + ' ' + a.horario) - new Date(b.data + ' ' + b.horario));
            
            renderizarProvas();
            atualizarEstatisticas();
            atualizarOpcoesDisponiveis();
            limparFormulario();
            
            alert('Prova agendada com sucesso!');
        }

        function renderizarProvas() {
            const container = document.getElementById('provasAgendadas');
            const emptyState = document.getElementById('emptyState');

            if (provas.length === 0) {
                container.innerHTML = '';
                emptyState.style.display = 'block';
                return;
            }

            emptyState.style.display = 'none';
            
            container.innerHTML = provas.map(prova => {
                const dataFormatada = new Date(prova.data + 'T00:00:00').toLocaleDateString('pt-BR');
                const isProxima = isProximaProva(prova);
                return `
                    <div class="d-flex align-items-center justify-content-between p-3 border rounded mb-2 ${isProxima ? 'border-primary bg-light' : 'border-secondary'}">
                        <div class="d-flex align-items-center">
                            <div class="disciplina-circle me-3 ${getCoresDisciplina(prova.disciplina)}">
                                ${prova.disciplinaNome.charAt(0)}
                            </div>
                            <div>
                                <div class="fw-semibold">${prova.disciplinaNome}</div>
                                <div class="text-muted small">📅 ${dataFormatada}</div>
                                <div class="text-muted small">🕐 ${prova.horarioTexto}</div>
                                ${isProxima ? '<span class="badge bg-primary mt-1">Próxima Prova</span>' : ''}
                            </div>
                        </div>
                        <div>
                            <span class="badge bg-success mb-2">Agendada</span>
                            <button onclick="removerProva(${prova.id})" class="btn btn-sm btn-outline-danger ms-2" title="Remover">
                                <i class="bi bi-trash"></i>
                            </button>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function getCoresDisciplina(disciplina) {
            switch (disciplina) {
                case 'matematica': return 'bg-matematica';
                case 'portugues': return 'bg-portugues';
                case 'historia': return 'bg-historia';
                case 'geografia': return 'bg-geografia';
                case 'ciencias': return 'bg-ciencias';
                case 'fisica': return 'bg-fisica';
                case 'quimica': return 'bg-quimica';
                default: return 'bg-default';
            }
        }

        function isProximaProva(prova) {
            const agora = new Date();
            const dataProva = new Date(prova.data + 'T' + prova.horario + ':00');
            const proximasProvas = provas.filter(p => {
                const dataP = new Date(p.data + 'T' + p.horario + ':00');
                return dataP > agora;
            });
            if (proximasProvas.length === 0) return false;
            const proximaProvaData = new Date(proximasProvas[0].data + 'T' + proximasProvas[0].horario + ':00');
            return dataProva.getTime() === proximaProvaData.getTime();
        }

        function removerProva(id) {
            if (confirm('Tem certeza que deseja remover esta prova?')) {
                provas = provas.filter(prova => prova.id !== id);
                renderizarProvas();
                atualizarEstatisticas();
                atualizarOpcoesDisponiveis();
            }
        }

        function atualizarOpcoesDisponiveis() {
            const selectDisciplina = document.getElementById('disciplina');
            const selectHorario = document.getElementById('horario');
            const inputData = document.getElementById('data');
            const disciplinasAgendadas = provas.map(prova => prova.disciplina);
            const opcoesDisciplina = selectDisciplina.querySelectorAll('option');
            opcoesDisciplina.forEach(opcao => {
                if (opcao.value && disciplinasAgendadas.includes(opcao.value)) {
                    opcao.disabled = true;
                    if (!opcao.textContent.includes(' (Indisponível)')) {
                        opcao.textContent += ' (Indisponível)';
                    }
                } else if (opcao.value) {
                    opcao.disabled = false;
                    opcao.textContent = opcao.textContent.replace(' (Indisponível)', '');
                }
            });

            function atualizarHorarios() {
                const dataSelecionada = inputData.value;
                if (!dataSelecionada) return;
                const horariosOcupados = provas
                    .filter(prova => prova.data === dataSelecionada)
                    .map(prova => prova.horario);
                const opcoesHorario = selectHorario.querySelectorAll('option');
                opcoesHorario.forEach(opcao => {
                    if (opcao.value && horariosOcupados.includes(opcao.value)) {
                        opcao.disabled = true;
                        if (!opcao.textContent.includes(' (Ocupado)')) {
                            opcao.textContent += ' (Ocupado)';
                        }
                    } else if (opcao.value) {
                        opcao.disabled = false;
                        opcao.textContent = opcao.textContent.replace(' (Ocupado)', '');
                    }
                });
            }
            inputData.removeEventListener('change', atualizarHorarios);
            inputData.addEventListener('change', atualizarHorarios);
            atualizarHorarios();
        }

        function atualizarEstatisticas() {
            document.getElementById('totalProvas').textContent = provas.length;
            const disciplinasUnicas = new Set(provas.map(prova => prova.disciplina));
            document.getElementById('disciplinasCount').textContent = disciplinasUnicas.size;
            const agora = new Date();
            const proximasProvas = provas.filter(prova => {
                const dataProva = new Date(prova.data + 'T' + prova.horario + ':00');
                return dataProva > agora;
            });
            if (proximasProvas.length > 0) {
                const proximaData = new Date(proximasProvas[0].data + 'T00:00:00');
                const diasRestantes = Math.ceil((proximaData - agora) / (1000 * 60 * 60 * 24));
                document.getElementById('proximaProva').textContent = diasRestantes > 0 ? `${diasRestantes}d` : 'Hoje';
            } else {
                document.getElementById('proximaProva').textContent = '-';
            }
        }

        function limparFormulario() {
            document.getElementById('disciplina').value = '';
            document.getElementById('data').value = '';
            document.getElementById('horario').value = '';
        }

        

        // Definir data mínima como hoje
        document.addEventListener('DOMContentLoaded', function () {
            document.getElementById('data').min = new Date().toISOString().split('T')[0];
            atualizarEstatisticas();
            atualizarOpcoesDisponiveis();
        });

        
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/main.js"></script>
</body>
</html>